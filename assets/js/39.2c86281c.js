(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{448:function(t,s,a){"use strict";a.r(s);var e=a(2),i=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"turing-a-language-for-flexible-probabilistic-inference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#turing-a-language-for-flexible-probabilistic-inference"}},[t._v("#")]),t._v(" Turing: a language for flexible probabilistic inference")]),t._v(" "),s("blockquote",[s("p",[t._v("文章链接：http://proceedings.mlr.press/v84/ge18b.html?ref=https://githubhelp.com")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/HFC666/image/master/img/Tur1.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"background"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" Background")]),t._v(" "),s("p",[t._v("在概率模型中，我们关注的一般是"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mo",[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v("∣")]),s("mi",[t._v("y")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("γ")]),s("mo",[t._v(")")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p(\\theta\\mid y,\\gamma)")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("，其中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("θ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")])])])]),t._v("为参数，"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("y")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")])])])]),t._v("为观测数据，"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("γ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\gamma")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])]),t._v("为一些确定了的超参数。")]),t._v(" "),s("h4",{attrs:{id:"models-as-computer-programs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#models-as-computer-programs"}},[t._v("#")]),t._v(" Models as computer programs")]),t._v(" "),s("p",[t._v("最早的概率编程语言为BUGS，可以追溯到20世纪90年代。下面展示了概率程序的一般结构。")]),t._v(" "),s("p",[t._v("输入：数据"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("y")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")])])])]),t._v("和超参数"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("γ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\gamma")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])])]),t._v(" "),s("p",[t._v("步骤1：定义全局参数：")]),t._v(" "),s("p",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msup",[s("mi",[t._v("θ")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("g")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("b")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1),s("mo",[t._v("∼")]),s("mi",[t._v("p")]),s("mo",[t._v("(")]),s("mo",[t._v("⋅")]),s("mo",[t._v("∣")]),s("mi",[t._v("γ")]),s("mo",[t._v(")")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta^{\\text{global}}\\sim p(\\cdot\\mid \\gamma)\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.899108em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1.149108em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.01389em"}},[t._v("g")]),s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("b")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"mclose"},[t._v(")")])])])])])]),t._v(" "),s("p",[t._v("步骤2：对于每一个观测"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("n")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y_n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("，定义(局部)隐变量并计算似然：")]),t._v(" "),s("p",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mtable",[s("mtr",[s("mtd",[s("mrow",[s("msubsup",[s("mi",[t._v("θ")]),s("mi",[t._v("n")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("c")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mi",[t._v("p")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mo",[t._v("⋅")]),s("mo",[t._v("∣")]),s("msubsup",[s("mi",[t._v("θ")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("n")]),s("mo",[t._v("−")]),s("mn",[t._v("1")])],1),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("c")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msup",[s("mi",[t._v("θ")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("g")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("b")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("γ")]),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1)],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("n")])],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mi",[t._v("p")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mo",[t._v("⋅")]),s("mo",[t._v("∣")]),s("msubsup",[s("mi",[t._v("θ")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("n")])],1),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("c")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msup",[s("mi",[t._v("θ")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("g")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("b")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("γ")]),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1)],1)],1)],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\n\\theta_n^{\\text{local}}&\\sim p\\left(\\cdot\\mid\\theta_{1:n-1}^{\\text{local}},\\theta^{\\text{global}},\\gamma\\right)\\\\\ny_n&\\sim p\\left(\\cdot\\mid \\theta_{1:n}^{\\text{local}},\\theta^{\\text{global}},\\gamma\\right)\n\\end{aligned}\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"1.5091080000000001em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"2.5182160000000007em","vertical-align":"-1.0091080000000006em"}}),s("span",{staticClass:"base displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mtable"},[s("span",{staticClass:"col-align-r"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.6100000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.247em","margin-left":"-0.02778em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticStyle:{top:"-0.4129999999999999em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("c")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"0.6491080000000005em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"col-align-l"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.6100000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size1"},[t._v("(")])]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.24700000000000003em","margin-left":"-0.02778em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit"},[t._v("n")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("c")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.01389em"}},[t._v("g")]),s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("b")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size1"},[t._v(")")])])])])]),s("span",{staticStyle:{top:"0.6491080000000005em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size1"},[t._v("(")])]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.247em","margin-left":"-0.02778em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit"},[t._v("n")])])])]),s("span",{staticStyle:{top:"-0.4129999999999999em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("c")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.01389em"}},[t._v("g")]),s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("b")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size1"},[t._v(")")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),t._v("​")])])])])])])])])])]),t._v(" "),s("p",[t._v("其中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("n")]),s("mo",[t._v("=")]),s("mn",[t._v("1")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("2")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mo",[t._v("⋯")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("N")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n=1,2,\\cdots,N")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8777699999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("2")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"minner"},[t._v("⋯")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),t._v("。")]),t._v(" "),s("p",[t._v("参数分为两类："),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msubsup",[s("mi",[t._v("θ")]),s("mi",[t._v("n")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("c")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta_n^{\\text{local}}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.849108em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1.096108em","vertical-align":"-0.247em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.247em","margin-left":"-0.02778em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("c")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("表示对于观测"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("n")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y_n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("的模型参数，如混合高斯模型中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("n")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y_n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("属于哪个高斯分布的参数，而"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msup",[s("mi",[t._v("θ")]),s("mrow",[s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("g")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("b")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("l")])],1)],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta^{\\text{global}}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.849108em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"text mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.01389em"}},[t._v("g")]),s("span",{staticClass:"mord mathrm"},[t._v("l")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("b")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("l")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v("表示全局变量。")]),t._v(" "),s("h4",{attrs:{id:"inference-for-probabilistic-programs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inference-for-probabilistic-programs"}},[t._v("#")]),t._v(" Inference for probabilistic programs")]),t._v(" "),s("p",[t._v("概率程序只有在与高效的推理引擎相结合时才能发挥其灵活性潜力。为了解释概率编程中推理如何工作，我们考虑以下具有"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("K")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("K")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")])])])]),t._v("个状态的HMM例子：")]),t._v(" "),s("p",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mtable",[s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("π")]),s("mi",[t._v("k")])],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("D")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("i")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("r")])],1),s("mo",[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v(")")])],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("ϕ")]),s("mi",[t._v("k")])],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mi",[t._v("p")]),s("mo",[t._v("(")]),s("mi",[t._v("γ")]),s("mo",[t._v(")")])],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("z")]),s("mi",[t._v("t")])],1),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mi",[t._v("t")]),s("mo",[t._v("−")]),s("mn",[t._v("1")])],1)],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("C")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("t")])],1),s("mo",[t._v("(")]),s("mo",[t._v("⋅")]),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("π")]),s("mrow",[s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mi",[t._v("t")]),s("mo",[t._v("−")]),s("mn",[t._v("1")])],1)],1)],1)],1),s("mo",[t._v(")")])],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("t")])],1),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("z")]),s("mi",[t._v("t")])],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mi",[t._v("h")]),s("mo",[t._v("(")]),s("mo",[t._v("⋅")]),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("ϕ")]),s("mrow",[s("msub",[s("mi",[t._v("z")]),s("mi",[t._v("t")])],1)],1)],1),s("mo",[t._v(")")])],1)],1)],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\n\\pi_k&\\sim \\text{Dir}(\\theta)\\\\\n\\phi_k&\\sim p(\\gamma)\\\\\nz_t\\mid z_{t-1}&\\sim \\text{Cat}(\\cdot\\mid \\pi_{z_{t-1}})\\\\\ny_t\\mid z_t&\\sim h(\\cdot\\mid \\phi_{z_t})\n\\end{aligned}\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"2.6500000000000004em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"4.800000000000001em","vertical-align":"-2.1500000000000004em"}}),s("span",{staticClass:"base displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mtable"},[s("span",{staticClass:"col-align-r"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-1.8100000000000003em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("π")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"-0.6100000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"0.5900000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"1.7900000000000003em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"col-align-l"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-1.8100000000000003em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"text mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("D")]),s("span",{staticClass:"mord mathrm"},[t._v("i")]),s("span",{staticClass:"mord mathrm"},[t._v("r")])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mclose"},[t._v(")")])])]),s("span",{staticStyle:{top:"-0.6100000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"mclose"},[t._v(")")])])]),s("span",{staticStyle:{top:"0.5900000000000001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"text mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("C")]),s("span",{staticClass:"mord mathrm"},[t._v("a")]),s("span",{staticClass:"mord mathrm"},[t._v("t")])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("π")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.14999999999999997em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.07142857142857144em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[s("span",{staticClass:"mord scriptscriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mclose"},[t._v(")")])])]),s("span",{staticStyle:{top:"1.7900000000000003em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15000000000000002em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.07142857142857144em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mclose"},[t._v(")")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])])])])]),t._v(" "),s("p",[t._v("其中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("k")]),s("mo",[t._v("=")]),s("mn",[t._v("1")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("2")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mo",[t._v("⋯")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("K")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k = 1,2,\\cdots,K")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("2")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"minner"},[t._v("⋯")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")])])])]),t._v("，"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("t")]),s("mo",[t._v("=")]),s("mn",[t._v("1")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mo",[t._v("⋯")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("N")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("t = 1,\\cdots,N")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8777699999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("t")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"minner"},[t._v("⋯")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),t._v("。")]),t._v(" "),s("p",[t._v("具有以下三个步骤的高效 Gibbs 采样器通常用于贝叶斯推理：")]),t._v(" "),s("ul",[s("li",[t._v("Step 1: Sample "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",[t._v("∼")]),s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("ϕ")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("K")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msub",[s("mi",[t._v("π")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("K")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msub",[s("mi",[t._v("y")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(";")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("z_{1: T} \\sim z_{1: T} \\mid \\phi_{1: K}, \\pi_{1: K}, y_{1: T} ;")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("π")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(";")])])])])]),t._v(" "),s("li",[t._v("Step 2: Sample "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("ϕ")]),s("mrow",[s("mi",[t._v("k")])],1)],1),s("mo",[t._v("∼")]),s("msub",[s("mi",[t._v("ϕ")]),s("mrow",[s("mi",[t._v("k")])],1)],1),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msub",[s("mi",[t._v("y")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("γ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\phi_{k} \\sim \\phi_{k} \\mid z_{1: T}, y_{1: T}, \\gamma")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")])])])]),t._v(";")]),t._v(" "),s("li",[t._v("Step 3: Sample "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("π")]),s("mrow",[s("mi",[t._v("k")])],1)],1),s("mo",[t._v("∼")]),s("msub",[s("mi",[t._v("π")]),s("mrow",[s("mi",[t._v("k")])],1)],1),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("T")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("θ")]),s("mo",[t._v("(")]),s("mi",[t._v("k")]),s("mo",[t._v("=")]),s("mn",[t._v("1")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mo",[t._v("…")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("K")]),s("mo",[t._v(")")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\pi_{k} \\sim \\pi_{k} \\mid z_{1: T}, \\theta(k=1, \\ldots, K)")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("π")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("π")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"minner"},[t._v("…")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")]),s("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v(".")])]),t._v(" "),s("h4",{attrs:{id:"computation-graph-based-inference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#computation-graph-based-inference"}},[t._v("#")]),t._v(" Computation graph based inference")]),t._v(" "),s("p",[t._v("对概率程序进行建模的一大挑战是构建模型变量之间的计算图。对于一些编程语言，在推理之前概率图模型就已经生成，但是当程序中存在随机分支时就会出现问题，在这种情况下，我们不得不求助于其他推理方法。")]),t._v(" "),s("h3",{attrs:{id:"composable-mcmc-inference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#composable-mcmc-inference"}},[t._v("#")]),t._v(" Composable MCMC inference")]),t._v(" "),s("p",[t._v("我们提出的可组合推理方法利用了HMC算法和粒子吉布斯(PG)算法。为了描述所提出的概率程序方法，我们利用潜在狄利克雷分配(LDA)的例子。")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("@model lda"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("K "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("M"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" alpha"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    theta "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Vector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Vector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Real"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("M"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" m "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("M\n        theta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" Dirichlet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("alpha"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    phi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Vector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Vector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Real"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("K"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" k "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("K\n        phi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" Dirichlet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("beta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    z "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tzeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("N\n        z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" Categorical"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("theta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" Categorical"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("phi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("其中变量"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("ϕ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("θ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("z")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\phi,\\theta,z")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")])])])]),t._v("表示模型参数，变量"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("K")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("M")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("N")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("d")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("β")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("α")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("K,M,N,d,\\beta,\\alpha")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("M")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit"},[t._v("d")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[t._v("β")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.0037em"}},[t._v("α")])])])]),t._v("表示超参数，"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("w")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("w")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")])])])]),t._v("表示观测数据。")]),t._v(" "),s("p",[t._v("一旦定义了模型，提供数据和执行推理就很直观了。")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lda"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("K"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" V"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" M"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" alpha"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsample"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" engine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("engine")]),t._v("是我们想要使用的MCMC引擎。例如，如果要应用例子吉布斯采样，我们可以：")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("spl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsample"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" spl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("这将会用含有"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("m")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("m")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("m")])])])]),t._v("个粒子的PG进行"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("n")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])])]),t._v("次迭代。")]),t._v(" "),s("p",[t._v("我们也可以对不同的参数采用不同的采样器：")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("spl2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Gibbs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HMC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("phi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("theta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("上述采样引擎"),s("code",[t._v("spl2")]),t._v("将参数分割为两部分，每个部分采用不同的采样方法，值得注意的是，分布的两个部分不需要是互斥的。")]),t._v(" "),s("h4",{attrs:{id:"a-family-of-mcmc-operators"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#a-family-of-mcmc-operators"}},[t._v("#")]),t._v(" A family of MCMC operators")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/HFC666/image/master/img/tur2.jpg",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("Supported Monte Carlo algorithms in Turing")])]),t._v(" "),s("h3",{attrs:{id:"implementation-and-experiments"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#implementation-and-experiments"}},[t._v("#")]),t._v(" Implementation and Experiments")]),t._v(" "),s("h4",{attrs:{id:"the-turing-library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-turing-library"}},[t._v("#")]),t._v(" The Turing library")]),t._v(" "),s("p",[t._v("Turing为Julia的一个包。因为Turing为一般的Julia程序，因此它可以利用Julia中丰富的数值和统计库。")]),t._v(" "),s("h5",{attrs:{id:"efficient-particle-gibbs-implementation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#efficient-particle-gibbs-implementation"}},[t._v("#")]),t._v(" Efficient particle Gibbs implementation")]),t._v(" "),s("p",[t._v("我们使用协程来实现粒子 Gibbs。协程可以看作是函数的泛化，具有可以在多个点暂停和恢复的特性。")]),t._v(" "),s("h5",{attrs:{id:"automatic-differentiation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#automatic-differentiation"}},[t._v("#")]),t._v(" Automatic differentiation")]),t._v(" "),s("p",[t._v("HMC在采样的过程需要梯度，当给定定义"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("log")]),s("mi",[t._v("p")]),s("mo",[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v("∣")]),s("msub",[s("mi",[t._v("z")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("N")])],1)],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("γ")]),s("mo",[t._v(")")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\log p(\\theta\\mid z_{1:N},\\gamma)")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mop"},[t._v("lo"),s("span",{staticStyle:{"margin-right":"0.01389em"}},[t._v("g")])]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mrel"},[t._v("∣")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.04398em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[t._v("γ")]),s("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("的计算程序时，这些梯度可以通过自动微分(AD)自动获得。为了简便和高效，我们率先使用了一种称为向量模式的前向微分技术。向量模式前向微分背后的主要概念是多维对偶数，其在标量函数上的行为定义为：")]),t._v(" "),s("p",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("f")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v("+")]),s("msubsup",[s("mo",[t._v("∑")]),s("mrow",[s("mi",[t._v("i")]),s("mo",[t._v("=")]),s("mn",[t._v("1")])],1),s("mi",[t._v("D")])],1),s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("i")])],1),s("msub",[s("mi",[t._v("ϵ")]),s("mi",[t._v("i")])],1),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1),s("mo",[t._v("=")]),s("mi",[t._v("f")]),s("mo",[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v(")")]),s("mo",[t._v("+")]),s("msup",[s("mi",[t._v("f")]),s("mrow",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("′")])],1)],1),s("mo",[t._v("(")]),s("mi",[t._v("θ")]),s("mo",[t._v(")")]),s("msubsup",[s("mo",[t._v("∑")]),s("mrow",[s("mi",[t._v("i")]),s("mo",[t._v("=")]),s("mn",[t._v("1")])],1),s("mi",[t._v("D")])],1),s("msub",[s("mi",[t._v("y")]),s("mi",[t._v("i")])],1),s("msub",[s("mi",[t._v("ϵ")]),s("mi",[t._v("i")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("f\\left(\\theta+\\sum_{i=1}^D y_i\\epsilon_i\\right) = f(\\theta) + f^{\\prime}(\\theta)\\sum_{i=1}^Dy_i\\epsilon_i\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"1.8283360000000002em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"3.106005em","vertical-align":"-1.277669em"}}),s("span",{staticClass:"base displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size4"},[t._v("(")])]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mbin"},[t._v("+")]),s("span",{staticClass:"mop op-limits"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"1.1776689999999999em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticStyle:{top:"-0.000005000000000143778em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",[s("span",{staticClass:"op-symbol large-op mop"},[t._v("∑")])])]),s("span",{staticStyle:{top:"-1.2500050000000003em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("D")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϵ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size4"},[t._v(")")])])]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mbin"},[t._v("+")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord scriptstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("′")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mop op-limits"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"1.1776689999999999em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticStyle:{top:"-0.000005000000000143778em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",[s("span",{staticClass:"op-symbol large-op mop"},[t._v("∑")])])]),s("span",{staticStyle:{top:"-1.2500050000000003em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("D")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϵ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])])]),t._v(" "),s("p",[t._v("其中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("ϵ")]),s("mi",[t._v("i")])],1),s("msub",[s("mi",[t._v("ϵ")]),s("mi",[t._v("j")])],1),s("mo",[t._v("=")]),s("mn",[t._v("0")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mtext",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("f")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("o")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("r")]),s("mtext")],1),s("mi",[t._v("i")]),s("mo",[t._v("≠")]),s("mi",[t._v("j")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\epsilon_i\\epsilon_j=0,\\text{for }i\\neq j")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.716em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1.002108em","vertical-align":"-0.286108em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϵ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϵ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"text mord textstyle uncramped"},[s("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.07778em"}},[t._v("f")]),s("span",{staticClass:"mord mathrm"},[t._v("o")]),s("span",{staticClass:"mord mathrm"},[t._v("r")]),s("span",{staticClass:"mord mspace"})]),s("span",{staticClass:"mord mathit"},[t._v("i")]),s("span",{staticClass:"mrel"},[t._v("≠")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05724em"}},[t._v("j")])])])]),t._v("。")]),t._v(" "),s("p",[t._v("对于小模型，向量前向AD非常高效。但是对于大模型逆向模式的AD较为高效，因此Turing两种模式都存在。")]),t._v(" "),s("h5",{attrs:{id:"vectorized-random-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vectorized-random-variables"}},[t._v("#")]),t._v(" Vectorized random variables")]),t._v(" "),s("p",[t._v("Turing支持利用以下语法对独立同分布的变量进行矢量化采样：")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("rv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Vector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("h5",{attrs:{id:"constrained-random-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#constrained-random-variables"}},[t._v("#")]),t._v(" Constrained random variables")]),t._v(" "),s("p",[t._v("Turing支持约束的变量。主要由三种类型的约束：")]),t._v(" "),s("ol",[s("li",[t._v("有界的单变量。")]),t._v(" "),s("li",[t._v("有简单约束的多维变量，如相加和为"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mn",[t._v("1")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("1")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.64444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),t._v("。")]),t._v(" "),s("li",[t._v("矩阵约束：例如协方差矩阵为半正定矩阵。")])]),t._v(" "),s("h5",{attrs:{id:"mcmc-output-analysis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mcmc-output-analysis"}},[t._v("#")]),t._v(" MCMC output analysis")]),t._v(" "),s("p",[t._v("在Turing中我们可以使用"),s("code",[t._v("describe")]),t._v("函数计算：")]),t._v(" "),s("ol",[s("li",[t._v("均值")]),t._v(" "),s("li",[t._v("标准差")]),t._v(" "),s("li",[t._v("naive standard error")]),t._v(" "),s("li",[t._v("蒙特卡洛标准误差")]),t._v(" "),s("li",[t._v("有效样本数")]),t._v(" "),s("li",[t._v("分位数")])]),t._v(" "),s("p",[t._v("也可以使用"),s("code",[t._v("hpd")]),t._v("函数计算高后验概率区间，互相关"),s("code",[t._v("cor")]),t._v("，自相关"),s("code",[t._v("autocor")]),t._v("，状态空间变化率"),s("code",[t._v("changerate")]),t._v("和偏差信息准则"),s("code",[t._v("dic")]),t._v("等等。")]),t._v(" "),s("h4",{attrs:{id:"finding-the-right-inference-engine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#finding-the-right-inference-engine"}},[t._v("#")]),t._v(" Finding the right inference engine")]),t._v(" "),s("p",[t._v("下面我们将比较"),s("code",[t._v("NUTS")]),t._v("和"),s("code",[t._v("Gibbs(PG,HMC)")]),t._v("在不同的概率模型上。")]),t._v(" "),s("h5",{attrs:{id:"models-and-inference-engine-setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#models-and-inference-engine-setup"}},[t._v("#")]),t._v(" Models and inference engine setup")]),t._v(" "),s("p",[s("strong",[t._v("Stochastic Volatility Model")]),t._v("：参数的集合为"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mo",[t._v("{")]),s("mi",[t._v("ϕ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("σ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("μ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msub",[s("mi",[t._v("h")]),s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v(":")]),s("mi",[t._v("N")])],1)],1),s("mo",[t._v("}")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\{\\phi,\\sigma,\\mu,h_{1:N}\\}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mopen"},[t._v("{")]),s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit"},[t._v("μ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mrel"},[t._v(":")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mclose"},[t._v("}")])])])]),t._v("。所有这些参数对于目标分布来说都是可导的，因此NUTS算法是可用的：")]),t._v(" "),s("p",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mtable",[s("mtr",[s("mtd",[s("mrow",[s("mi",[t._v("μ")])],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("C")])],1),s("mrow",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")])],1),s("mo",[t._v("(")]),s("mn",[t._v("0")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("1")]),s("mn",[t._v("0")]),s("mo",[t._v(")")]),s("mo",[t._v(")")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("ϕ")]),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("U")])],1),s("mrow",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("n")])],1),s("mo",[t._v("(")]),s("mo",[t._v("−")]),s("mn",[t._v("1")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("1")]),s("mo",[t._v(")")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("σ")]),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("C")])],1),s("mrow",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")])],1),s("mo",[t._v("(")]),s("mn",[t._v("0")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("5")]),s("mo",[t._v(")")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mspace",{attrs:{width:"1em"}}),s("mo",[t._v("(")]),s("mi",[t._v("σ")]),s("mo",[t._v(">")]),s("mn",[t._v("0")]),s("mo",[t._v(")")])],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("h")]),s("mrow",[s("mn",[t._v("1")])],1)],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("N")])],1),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mi",[t._v("μ")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("σ")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),s("msqrt",[s("mrow",[s("mn",[t._v("1")]),s("mo",[t._v("−")]),s("msup",[s("mi",[t._v("ϕ")]),s("mrow",[s("mn",[t._v("2")])],1)],1)],1)],1),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("msub",[s("mi",[t._v("h")]),s("mrow",[s("mi",[t._v("n")])],1)],1),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("N")])],1),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mi",[t._v("μ")]),s("mo",[t._v("+")]),s("mi",[t._v("ϕ")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("msub",[s("mi",[t._v("h")]),s("mrow",[s("mi",[t._v("n")]),s("mo",[t._v("−")]),s("mn",[t._v("1")])],1)],1),s("mo",[t._v("−")]),s("mi",[t._v("μ")]),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("σ")]),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1)],1)],1)],1),s("mtr",[s("mtd",[s("mrow",[s("msub",[s("mi",[t._v("y")]),s("mrow",[s("mi",[t._v("n")])],1)],1)],1)],1),s("mtd",[s("mrow",[s("mrow"),s("mo",[t._v("∼")]),s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("N")])],1),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("mn",[t._v("0")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("exp")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("(")]),s("msub",[s("mi",[t._v("h")]),s("mrow",[s("mi",[t._v("n")])],1)],1),s("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),s("mn",[t._v("2")]),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1),s("mo",{attrs:{fence:"true"}},[t._v(")")])],1),s("mspace",{attrs:{width:"1em"}}),s("mo",[t._v("(")]),s("mi",[t._v("n")]),s("mo",[t._v("=")]),s("mn",[t._v("2")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mn",[t._v("3")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mo",[t._v("…")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("N")]),s("mo",[t._v(")")]),s("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1)],1)],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{aligned}\n\\mu &\\sim \\mathcal{C} \\mathrm{a}(0,10)), \\phi \\sim \\mathcal{U} \\mathrm{n}(-1,1), \\sigma \\sim \\mathcal{C} \\mathrm{a}(0,5), \\quad(\\sigma>0) \\\\\nh_{1} & \\sim \\mathcal{N}\\left(\\mu, \\sigma / \\sqrt{1-\\phi^{2}}\\right), h_{n} \\sim \\mathcal{N}\\left(\\mu+\\phi\\left(h_{n-1}-\\mu\\right), \\sigma\\right) \\\\\ny_{n} & \\sim \\mathcal{N}\\left(0, \\exp \\left(h_{n} / 2\\right)\\right) \\quad(n=2,3, \\ldots, N) .\n\\end{aligned}\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"2.35001em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"4.20002em","vertical-align":"-1.8500100000000002em"}}),s("span",{staticClass:"base displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mtable"},[s("span",{staticClass:"col-align-r"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-1.51001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("μ")])])]),s("span",{staticStyle:{top:"-0.000010000000000065512em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"1.49001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"col-align-l"},[s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-1.51001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.05834em"}},[t._v("C")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("a")])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.09931em"}},[t._v("U")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("n")])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord"},[t._v("−")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.05834em"}},[t._v("C")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("a")])]),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("5")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mspace quad"}),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),s("span",{staticClass:"mrel"},[t._v(">")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mclose"},[t._v(")")])])]),s("span",{staticStyle:{top:"-0.000010000000000065512em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.14736em"}},[t._v("N")])]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size2"},[t._v("(")])]),s("span",{staticClass:"mord mathit"},[t._v("μ")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),s("span",{staticClass:"mord mathrm"},[t._v("/")]),s("span",{staticClass:"sqrt mord"},[s("span",{staticClass:"sqrt-sign",staticStyle:{top:"-0.1167140000000001em"}},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped"},[s("span",{staticClass:"delimsizing size1"},[t._v("√")])])]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("1")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"-0.289em","margin-right":"0.05em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathrm"},[t._v("2")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])]),s("span",{staticStyle:{top:"-0.926714em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle textstyle uncramped sqrt-line"})]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size2"},[t._v(")")])])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.14736em"}},[t._v("N")])]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v("(")]),s("span",{staticClass:"mord mathit"},[t._v("μ")]),s("span",{staticClass:"mbin"},[t._v("+")]),s("span",{staticClass:"mord mathit"},[t._v("ϕ")]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v("(")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathrm"},[t._v("1")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathit"},[t._v("μ")]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v(")")])]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("σ")]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v(")")])])])]),s("span",{staticStyle:{top:"1.49001em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord displaystyle textstyle uncramped"}),s("span",{staticClass:"mrel"},[t._v("∼")]),s("span",{staticClass:"mord displaystyle textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.14736em"}},[t._v("N")])]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v("(")]),s("span",{staticClass:"mord mathrm"},[t._v("0")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mop"},[t._v("exp")]),s("span",{staticClass:"minner displaystyle textstyle uncramped"},[s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v("(")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("n")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mord mathrm"},[t._v("/")]),s("span",{staticClass:"mord mathrm"},[t._v("2")]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v(")")])]),s("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[t._v(")")])]),s("span",{staticClass:"mord mspace quad"}),s("span",{staticClass:"mopen"},[t._v("(")]),s("span",{staticClass:"mord mathit"},[t._v("n")]),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mord mathrm"},[t._v("2")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathrm"},[t._v("3")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"minner"},[t._v("…")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")]),s("span",{staticClass:"mclose"},[t._v(")")]),s("span",{staticClass:"mord mathrm"},[t._v(".")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"1em"}},[t._v("​")])]),t._v("​")])])])])])])])])])]),t._v(" "),s("p",[t._v("其中"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mrow",[s("mi",{attrs:{mathvariant:"script"}},[t._v("C")])],1),s("mrow",[s("mi",{attrs:{mathvariant:"normal"}},[t._v("a")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\mathcal{C}\\mathrm{a}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord textstyle uncramped"},[s("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.05834em"}},[t._v("C")])]),s("span",{staticClass:"mord textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("a")])])])])]),t._v("表示柯西分布。")]),t._v(" "),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("spl1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NUTS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nspl2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Gibbs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NUTS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("phi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("sigma"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("Gaussian Mixture Model")]),t._v("：参数的集合为"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mo",[t._v("{")]),s("mi",[t._v("z")]),s("mo",{attrs:{separator:"true"}},[t._v(",")]),s("mi",[t._v("θ")]),s("mo",[t._v("}")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\{z,\\theta\\}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mopen"},[t._v("{")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")]),s("span",{staticClass:"mpunct"},[t._v(",")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")]),s("span",{staticClass:"mclose"},[t._v("}")])])])]),t._v("，其中参数"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("θ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")])])])]),t._v("是可导的，参数"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("z")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("z")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")])])])]),t._v("不可以。为了运行NUTS算法，我们积分积掉"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("z")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("z")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.04398em"}},[t._v("z")])])])]),t._v("只对"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("θ")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\theta")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("θ")])])])]),t._v("采样：")]),t._v("\n\\begin{array}{r}\n\\mu=\\left(\\mu_{1: K}\\right), \\quad \\sigma=\\left(\\sigma_{1: K}\\right), \\quad \\pi=\\left(p_{1: K}\\right) \\\\\nz \\sim \\operatorname{Cat}(\\pi), \\quad \\theta \\sim \\mathcal{N}\\left(\\mu_{z}, \\sigma_{z}\\right)\n\\end{array}\n\n"),s("div",{staticClass:"language-julia extra-class"},[s("pre",{pre:!0,attrs:{class:"language-julia"}},[s("code",[t._v("spl3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NUTS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nspl4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Gibbs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NUTS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("theta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h5",{attrs:{id:"results"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#results"}},[t._v("#")]),t._v(" Results")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/HFC666/image/master/img/tur3.jpg",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v('上图为在GMM模型上trace plot，下图为联合分布的概率的对数的图，可以看到两个算法都达到了收敛，但是NUTS算法在某些对方被"困住了"。在下图更明显。')])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/HFC666/image/master/img/tur4.jpg",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("对具有"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mn",[t._v("5")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("5")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.64444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathrm"},[t._v("5")])])])]),t._v("个混合的GMM采样的结果，可以更明显地看到NUTS算法被困住了，在图的上半部分只探索到了两个混合成分。")])])])}),[],!1,null,null,null);s.default=i.exports}}]);